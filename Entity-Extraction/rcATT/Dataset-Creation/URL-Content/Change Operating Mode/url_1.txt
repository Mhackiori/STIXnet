Change Operating Mode Jump to navigation Jump to search |Change Operating Mode| |Technique| |ID||T0858| |Tactic||Execution, Evasion| |Data Sources||Network Traffic: Network Traffic Content, Application Log: Application Log Content, Operational Databases: Device Alarm| |Asset||Safety Instrumented System/Protection Relay, Field Controller/RTU/PLC/IED| Description Adversaries may change the operating mode of a controller to gain additional access to engineering functions such as Program Download. Programmable controllers typically have several modes of operation that control the state of the user program and control access to the controller’s API. Operating modes can be physically selected using a key switch on the face of the controller but may also be selected with calls to the controller’s API. Operating modes and the mechanisms by which they are selected often vary by vendor and product line. Some commonly implemented operating modes are described below: - Program - This mode must be enabled before changes can be made to a device’s program. This allows program uploads and downloads between the device and an engineering workstation. Often the PLC’s logic Is halted, and all outputs may be forced off.1 - Run - Execution of the device’s program occurs in this mode. Input and output (values, points, tags, elements, etc.) are monitored and used according to the program’s logic. Program Upload and Program Download are disabled while in this mode.2314 - Reset - Conditions on the PLC are reset to their original states. Warm resets may retain some memory while cold resets will reset all I/O and data registers.3 - Test / Monitor mode - Similar to run mode, I/O is processed, although this mode allows for monitoring, force set, resets, and more generally tuning or debugging of the system. Often monitor mode may be used as a trial for initialization.2 Procedure Examples - PLC-Blaster stops the execution of the user program on the target to enable the transfer of its own code. The worm then copies itself to the target and subsequently starts the target PLC again.5 - Triton has the ability to halt or run a program through the TriStation protocol. TsHi.py contains instances of halt and run functions being executed.6 Mitigations - Authorization Enforcement - All field controllers should restrict operating mode changes to only required authenticated users (e.g., engineers, field technicians), preferably through implementing a role-based access mechanism. Further, physical mechanisms (e.g., keys) can also be used to limit unauthorized operating mode changes. - Human User Authentication - All field controllers should require users to authenticate for all remote or local management sessions. The authentication mechanisms should also support Account Use Policies, Password Policies, and User Account Management. - Communication Authenticity - Protocols used for device management should authenticate all network messages to prevent unauthorized system changes. - Network Allowlists - Use host-based allowlists to prevent devices from accepting connections from unauthorized systems. For example, allowlists can be used to ensure devices can only connect with master stations or known management/engineering workstations.7 - Access Management - Authenticate all access to field controllers before authorizing access to, or modification of, a device's state, logic, or programs. Centralized authentication techniques can help manage the large number of field controller accounts needed across the ICS. - Software Process and Device Authentication - Authenticate connections from software and devices to prevent unauthorized systems from accessing protected management functions. - Network Segmentation - Segment operational network and systems to restrict access to critical system functions to predetermined management systems.7 References - a b N.A.. (2017, October). What are the different operating modes in PLC?. Retrieved January 28, 2021. - a b Omron. (n.d.). PLC Different Operating Modes. Retrieved January 28, 2021. - a b c Machine Information Systems. (2007). How PLCs Work. Retrieved January 28, 2021. - a b PLCgurus. (2021). PLC Basics – Modes Of Operation. Retrieved January 28, 2021. - ^ Spenneberg, Ralf, Maik Brüggemann, and Hendrik Schwartke. (2016, March 31). Plc-blaster: A worm living solely in the plc.. Retrieved September 19, 2017. - ^ MDudek-ICS. (n.d.). TRISIS-TRITON-HATMAN. Retrieved November 3, 2019. - a b Department of Homeland Security. (2016, September). Retrieved September 25, 2020.