auditpol.exe - File Path: C:\Windows\SysWOW64\auditpol.exe - Description: Audit Policy Program Hashes |Type||Hash| |MD5| |SHA1| |SHA256| |SHA384| |SHA512| |SSDEEP| Runtime Data Usage (stdout): Usage: AuditPol command [<sub-command><options>] Commands (only one command permitted per execution) /? Help (context-sensitive) /get Displays the current audit policy. /set Sets the audit policy. /list Displays selectable policy elements. /backup Saves the audit policy to a file. /restore Restores the audit policy from a file. /clear Clears the audit policy. /remove Removes the per-user audit policy for a user account. /resourceSACL Configure global resource SACLs Use AuditPol <command> /? for details on each command Usage (stderr): Error 0x00000057 occurred: The parameter is incorrect. Signature - Status: Signature verified. - Serial: 33000000BCE120FDD27CC8EE930000000000BC - Thumbprint: E85459B23C232DB3CB94C7A56D47678F58E8E51E - Issuer: CN=Microsoft Windows Production PCA 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US - Subject: CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington, C=US File Metadata - Original Filename: AUDITPOL.EXE.MUI - Product Name: Microsoft Windows Operating System - Company Name: Microsoft Corporation - File Version: 10.0.14393.0 (rs1_release.160715-1616) - Product Version: 10.0.14393.0 - Language: English (United States) - Legal Copyright: Microsoft Corporation. All rights reserved. Possible Misuse The following table contains possible examples of auditpol.exe being misused. While auditpol.exe is not inherently malicious, its legitimate functionality can be abused for malicious purposes. |Source||Source File||Example||License| |sigma||win_sus_auditpol_usage.yml||DRL 1.0| |sigma||win_sus_auditpol_usage.yml||DRL 1.0| |sigma||win_sus_auditpol_usage.yml||DRL 1.0| |atomic-red-team||T1562.002.md||Use the cleanup commands to restore some default auditpol settings (your original settings will be lost)||MIT License. © 2018 Red Canary| |atomic-red-team||T1562.002.md||auditpol /set /category:”Account Logon” /success:disable /failure:disable||MIT License. © 2018 Red Canary| |atomic-red-team||T1562.002.md||auditpol /set /category:”Logon/Logoff” /success:disable /failure:disable||MIT License. © 2018 Red Canary| |atomic-red-team||T1562.002.md||auditpol /set /category:”Detailed Tracking” /success:disable||MIT License. © 2018 Red Canary| |atomic-red-team||T1562.002.md||auditpol /set /category:”Account Logon” /success:enable /failure:enable||MIT License. © 2018 Red Canary| |atomic-red-team||T1562.002.md||auditpol /set /category:”Detailed Tracking” /success:enable||MIT License. © 2018 Red Canary| |atomic-red-team||T1562.002.md||auditpol /set /category:”Logon/Logoff” /success:enable /failure:enable||MIT License. © 2018 Red Canary| |atomic-red-team||T1562.002.md||Clear the Windows audit policy using auditpol utility. This action would stop certain audit events from being recorded in the security log.||MIT License. © 2018 Red Canary| |atomic-red-team||T1562.002.md||auditpol /clear /y||MIT License. © 2018 Red Canary| |atomic-red-team||T1562.002.md||auditpol /remove /allusers||MIT License. © 2018 Red Canary| Additional Info* *The information below is copied from MicrosoftDocs, which is maintained by Microsoft. Available under CC BY 4.0 license. auditpol Displays information about and performs functions to manipulate audit policies, including: Setting and querying a system audit policy. Setting and querying a per-user audit policy. Setting and querying auditing options. Setting and querying the security descriptor used to delegate access to an audit policy. Reporting or backing up an audit policy to a comma-separated value (CSV) text file. Loading an audit policy from a CSV text file. Configuring global resource SACLs. Syntax auditpol command [<sub-command><options>] Parameters |Sub-command||Description| |/get||Displays the current audit policy. For more information, see auditpol get for syntax and options.| |/set||Sets the audit policy. For more information, see auditpol set for syntax and options.| |/list||Displays selectable policy elements. For more information, see auditpol list for syntax and options.| |/backup||Saves the audit policy to a file. For more information, see auditpol backup for syntax and options.| |/restore||Restores the audit policy from a file that was previously created by using auditpol /backup. For more information, see auditpol restore for syntax and options.| |/clear||Clears the audit policy. For more information, see auditpol clear for syntax and options.| |/remove||Removes all per-user audit policy settings and disables all system audit policy settings. For more information, see auditpol remove for syntax and options.| |/resourceSACL||Configures global resource system access control lists (SACLs). Note: Applies only to Windows 7 and Windows Server 2008 R2. For more information, see auditpol resourceSACL.| |/?||Displays help at the command prompt.| Additional References MIT License. Copyright (c) 2020-2021 Strontic.