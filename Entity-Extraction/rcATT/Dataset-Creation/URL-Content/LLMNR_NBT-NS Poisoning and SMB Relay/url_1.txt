Link-Local Multicast Name Resolution Jump to navigation Jump to search This article needs additional citations for verification. (September 2018) |Internet protocol suite| |Application layer| |Transport layer| |Internet layer| |Link layer| The Link-Local Multicast Name Resolution (LLMNR) is a protocol based on the Domain Name System (DNS) packet format that allows both IPv4 and IPv6 hosts to perform name resolution for hosts on the same local link. It is included in Windows Vista, Windows Server 2008, Windows 7, Windows 8 and Windows 10.[1] It is also implemented by systemd-resolved on Linux.[2] LLMNR is defined in RFC 4795 but was not adopted as an IETF standard.[3] Protocol details[edit] In responding to queries, responders listen on UDP port 5355 on the following link-scope Multicast address: - IPv4 - 224.0.0.252, MAC address 01-00-5E-00-00-FC - IPv6 - FF02:0:0:0:0:0:1:3 (this notation can be abbreviated as FF02::1:3), MAC address 33-33-00-01-00-03 The responders also listen on TCP port 5355 on the unicast address that the host uses to respond to queries. Packet header structure[edit] - ID - A 16-bit identifier assigned by the program that generates any kind of query. - QR - Query/Response. - OPCODE - A 4-bit field that specifies the kind of query in this message. This value is set by the originator of a query and copied into the response. This specification defines the behavior of standard queries and responses (opcode value of zero). Future specifications may define the use of other opcodes with LLMNR. - C - Conflict. - TC - TrunCation. - T - Tentative. - Z - Reserved for future use. - RCODE - Response code. - QDCOUNT - An unsigned 16-bit integer specifying the number of entries in the question section. - ANCOUNT - An unsigned 16-bit integer specifying the number of resource records in the answer section. - NSCOUNT - An unsigned 16-bit integer specifying the number of name server resource records in the authority records section. - ARCOUNT - An unsigned 16-bit integer specifying the number of resource records in the additional records section. See also[edit] - Network Basic Input/Output System (NetBIOS) - Peer Name Resolution Protocol (PNRP) - Multicast DNS (mDNS) - Zero-configuration networking (Zeroconf) References[edit] - ^ LLMNR: The Cable Guy - ^ "systemd 216 available". Retrieved 2015-08-10. - ^ Mikael Eiman (2015-05-25). "LLMNR, Multicast DNS and names on your LAN". Retrieved 2021-01-30. External links[edit] - Link-Local Multicast Name Resolution, Microsoft TechNet - RFC 4795, Informational, Link-Local Multicast Name Resolution (LLMNR) - LLMNR, Multicast DNS and names on your LAN