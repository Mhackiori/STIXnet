Man in the Middle Jump to navigation Jump to search |Man in the Middle| |Technique| |ID||T0830| |Tactic||Collection| |Data Sources||Network Traffic: Network Traffic Flow, Network Traffic: Network Traffic Content, Process: OS API Execution, Process: Process Creation, Command: Command Execution| |External Contributors||Conrad Layne - GE Digital| |Asset||Control Server, Field Controller/RTU/PLC/IED, Human-Machine Interface| Description Adversaries with privileged network access may seek to modify network traffic in real time using man-in-the-middle (MITM) attacks.1 This type of attack allows the adversary to intercept traffic to and/or from a particular device on the network. If a MITM attack is established, then the adversary has the ability to block, log, modify, or inject traffic into the communication stream. There are several ways to accomplish this attack, but some of the most-common are Address Resolution Protocol (ARP) poisoning and the use of a proxy.2 A MITM attack may allow an adversary to perform the following attacks: Block Reporting Message, Spoof Reporting Message, Modify Parameter, Unauthorized Command Message Procedure Examples - The VPNFilter's ssler module configures the device's iptables to redirect all traffic destined for port 80 to its local service listening on port 8888. Any outgoing web requests on port 80 are now intercepted by ssler and can be inspected by the ps module and manipulated before being sent to the legitimate HTTP service.34 Mitigations - Communication Authenticity - Communication authenticity will ensure that any messages tampered with through MITM can be detected, but cannot prevent eavesdropping on these. In addition, providing communication authenticity around various discovery protocols, such as DNS, can be used to prevent various MITM procedures. - Out-of-Band Communications Channel - Utilize out-of-band communication to validate the integrity of data from the primary channel. - Software Process and Device Authentication - To protect against MITM, authentication mechanisms should not send credentials across the network in plaintext and should also implement mechanisms to prevent replay attacks (such as nonces or timestamps). Challenge-response based authentication techniques that do not directly send credentials over the network provide better protection from MITM. - Static Network Configuration - Statically defined ARP entries can prevent manipulation and sniffing of switched network traffic, as some MitM techniques depend on sending spoofed ARP messages to manipulate network host's dynamic ARP tables. - Disable or Remove Feature or Program - Disable unnecessary legacy network protocols that may be used for MiTM if applicable. - Network Intrusion Prevention - Network intrusion detection and prevention systems that can identify traffic patterns indicative of MiTM activity can be used to mitigate activity at the network level. - Network Segmentation - Network segmentation can be used to isolate infrastructure components that do not require broad network access. This may mitigate, or at least alleviate, the scope of MiTM activity. - Filter Network Traffic - Use network appliances and host-based security software to block network traffic that is not necessary within the environment, such as legacy protocols that may be leveraged for MiTM. - Audit - Limit access to network infrastructure and resources that can be used to reshape traffic or otherwise produce MiTM conditions. References - ^ Gabriel Sanchez. (2017, October). Man-In-The-Middle Attack Against Modbus TCP Illustrated with Wireshark. Retrieved January 5, 2020. - ^ Bonnie Zhu, Anthony Joseph, Shankar Sastry. (2011). A Taxonomy of Cyber Attacks on SCADA Systems. Retrieved January 12, 2018. - ^ William Largent. (2018, June 06). VPNFilter Update - VPNFilter exploits endpoints, targets new devices. Retrieved March 28, 2019. - ^ Carl Hurd. (2019, March 26). VPNFilter Deep Dive. Retrieved March 28, 2019.